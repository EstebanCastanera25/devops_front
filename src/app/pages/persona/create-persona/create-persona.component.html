<div class="container-full">
  <h2 class="titulo-centrado">Crear Miembro</h2>

  <mat-dialog-content class="container-full">
    <form [formGroup]="persona" class="grid-datos">

      <mat-form-field appearance="outline" class="span-1">
        <mat-label>Nombres</mat-label>
        <input matInput formControlName="nombres" />
        <mat-error *ngIf="persona.get('nombres')?.hasError('required') && persona.get('nombres')?.touched">
          El nombre es requerido
        </mat-error>
        <mat-error *ngIf="persona.get('nombres')?.hasError('minlength') && persona.get('nombres')?.touched">
          Debe tener al menos {{PERSONA_VALIDATION.NOMBRES_VALIDATION.minLength}} caracteres
        </mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="span-1">
        <mat-label>Apellidos</mat-label>
        <input matInput formControlName="apellidos" />
        <mat-error *ngIf="persona.get('apellidos')?.hasError('required') && persona.get('apellidos')?.touched">
          El apellido es requerido
        </mat-error>
      </mat-form-field>

      <div formGroupName="datosContacto" class="span-1">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Teléfono móvil</mat-label>
          <input matInput formControlName="telefono_movil">
          <mat-error *ngIf="persona.get('datosContacto.telefono_movil')?.hasError('required') && persona.get('datosContacto.telefono_movil')?.touched">
            El teléfono móvil es requerido
          </mat-error>
        </mat-form-field>
      </div>

      <div formGroupName="identificacion" class="span-1">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>DNI</mat-label>
          <input matInput formControlName="dni" />
        </mat-form-field>
      </div>

      <mat-form-field appearance="outline" class="span-4">
        <mat-label>Observaciones</mat-label>
        <input matInput formControlName="observaciones">
      </mat-form-field>

      <!-- CONTACTO -->
      <div class="secciones span-4">
        <mat-accordion>
          <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
              <mat-panel-title>Datos de contacto</mat-panel-title>
              <mat-panel-description>Email, país y teléfonos</mat-panel-description>
            </mat-expansion-panel-header>

            <div formGroupName="datosContacto" class="inner-grid">
              <mat-form-field appearance="outline" class="span-2">
                <mat-label>Correo electrónico</mat-label>
                <input matInput formControlName="email" />
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>País</mat-label>
                <mat-select formControlName="pais">
                  <mat-option *ngFor="let p of paises" [value]="p">{{ p }}</mat-option>
                </mat-select>
                <mat-error *ngIf="persona.get('datosContacto.pais')?.hasError('required') && persona.get('datosContacto.pais')?.touched">
                  El país es requerido
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Teléfono fijo</mat-label>
                <input matInput formControlName="telefono_fijo" />
              </mat-form-field>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>

      <!-- PERSONALES -->
      <div class="secciones span-4">
        <mat-accordion>
          <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
              <mat-panel-title>Personales</mat-panel-title>
            </mat-expansion-panel-header>

            <div formGroupName="datosPersonales" class="inner-grid">
              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Género</mat-label>
                <mat-select formControlName="genero">
                  <mat-option *ngFor="let g of generos" [value]="g">{{ g }}</mat-option>
                </mat-select>
                <mat-error *ngIf="persona.get('datosPersonales.genero')?.hasError('required') && persona.get('datosPersonales.genero')?.touched">
                  El género es requerido
                </mat-error>
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Profesión</mat-label>
                <input matInput formControlName="profesion" />
              </mat-form-field>

              <mat-form-field color="accent" appearance="outline" class="span-1">
                <mat-label>Fecha</mat-label>
                <input matInput [matDatepicker]="picker" formControlName="f_nacimiento" placeholder="DD-MM-YYYY">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>

      <!-- DOMICILIO -->
      <div class="secciones span-4">
        <mat-accordion>
          <mat-expansion-panel [expanded]="true">
            <mat-expansion-panel-header>
              <mat-panel-title>Domicilio</mat-panel-title>
            </mat-expansion-panel-header>

            <div formGroupName="domicilio" class="inner-grid">

              <ng-container *ngIf="pais === 'Argentina'; else provinciaLibre">
                <mat-form-field appearance="outline" class="span-1">
                  <mat-label>Provincia</mat-label>
                  <mat-select formControlName="provincia">
                    <mat-option *ngFor="let prov of provincias_arg" [value]="prov">{{ prov }}</mat-option>
                  </mat-select>
                  <mat-error *ngIf="persona.get('domicilio.provincia')?.hasError('required') && persona.get('domicilio.provincia')?.touched">
                    La provincia es requerida
                  </mat-error>
                </mat-form-field>
              </ng-container>

              <ng-template #provinciaLibre>
                <mat-form-field appearance="outline" class="span-1">
                  <mat-label>Provincia</mat-label>
                  <input matInput formControlName="provincia" />
                  <mat-error *ngIf="persona.get('domicilio.provincia')?.hasError('required') && persona.get('domicilio.provincia')?.touched">
                    La provincia es requerida
                  </mat-error>
                </mat-form-field>
              </ng-template>

              <ng-container *ngIf="provincia !== 'Ciudad Autónoma de Buenos Aires'">
                <mat-form-field appearance="outline" class="span-1">
                  <mat-label>Ciudad</mat-label>
                  <input matInput formControlName="ciudad" />
                </mat-form-field>
              </ng-container>

              <ng-container *ngIf="provincia === 'Ciudad Autónoma de Buenos Aires'; else barrioLibre">
                <mat-form-field appearance="outline" class="span-1">
                  <mat-label>Barrio</mat-label>
                  <mat-select formControlName="barrio">
                    <mat-option *ngFor="let b of barrios_caba" [value]="b">{{ b }}</mat-option>
                  </mat-select>
                </mat-form-field>
              </ng-container>
              <ng-template #barrioLibre>
                <mat-form-field appearance="outline" class="span-1">
                  <mat-label>Barrio</mat-label>
                  <input matInput formControlName="barrio" />
                </mat-form-field>
              </ng-template>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Calle</mat-label>
                <input matInput formControlName="calle" />
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Número</mat-label>
                <input matInput formControlName="numero" />
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Piso</mat-label>
                <input matInput formControlName="piso" />
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Departamento</mat-label>
                <input matInput formControlName="departamento" />
              </mat-form-field>

              <mat-form-field appearance="outline" class="span-1">
                <mat-label>Código Postal</mat-label>
                <input matInput formControlName="codigoPostal" />
              </mat-form-field>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>

      <!-- ESTADOS -->
      <div class="secciones span-4">
        <mat-accordion>
          <mat-expansion-panel>
            <mat-expansion-panel-header>
              <mat-panel-title>Estados</mat-panel-title>
            </mat-expansion-panel-header>

            <div formGroupName="estado" class="inner-grid inner-grid--2cols">
              <mat-checkbox formControlName="afiliado">Afiliado</mat-checkbox>
              <mat-checkbox formControlName="en_whatsaap">En Grupo WhatsApp</mat-checkbox>
            </div>
          </mat-expansion-panel>
        </mat-accordion>
      </div>

    </form>
  </mat-dialog-content>
</div>

<mat-dialog-actions align="start" class="actions">
  <button mat-raised-button color="primary" (click)="guardarPersona()" [disabled]="persona.invalid">Guardar</button>
  <button mat-raised-button color="warn" (click)="cancelar()">Cancelar</button>
</mat-dialog-actions>